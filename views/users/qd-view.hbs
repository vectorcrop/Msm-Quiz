<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<br><br>
<br>
<br>
<center>

    {{#each juniors.[0].questions}}
    <h2>{{this.key}}. {{this.question}}</h2>
   <button class="btn btn-outline-dark answer {{this.key}}" data-answer="A" data-key="{{this.key}}">{{this.a}}</button><br>
    <button class="btn btn-outline-dark answer {{this.key}}" data-answer="B" data-key="{{this.key}}">{{this.b}}</button><br>
    <button class="btn btn-outline-dark answer {{this.key}}" data-answer="C" data-key="{{this.key}}">{{this.c}}</button><br>
    <button class="btn btn-outline-dark answer {{this.key}}" data-answer="D" data-key="{{this.key}}">{{this.d}}</button>
    {{/each}}
      <input id="ssno" value="{{juniors.[0]._id}}" hidden><br>
    <button id="submitBtn" class="btn btn-primary">Submit Answers</button>
</center>


<script>
    $(document).ready(function() {
        let answers = [];

        // Event listener for clicking on answer buttons
        $('.answer').click(function() {
            const qKey = $(this).data('key');
            const slAns = $(this).data('answer');

            // Disable all answer buttons for the clicked question except the clicked one
            $(`.${qKey}`).not(this).prop('disabled', true);
            $(this).css('background-color', 'yellow');

            // Push selected answer to the answers array
            answers.push({ qKey: qKey, slAns: slAns });
            $(this).prop('disabled', true);
        });

        // Event listener for clicking on the submit button
        $('#submitBtn').click(function() {
            // Send answers to the server (you can customize this part)
            let ss = $('#ssno').val();
            let qw = window.location.href.split('/').pop();

            $.ajax({
                url: `/qd-view/${ss}`, // Change this to your server endpoint
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ answers: answers, qw: qw }),
                success: function(response) {
                    console.log('Server response:', response);
                    answers = [];
                    // Check if the server response contains the new URL
                    if (response && response.redirectUrl) {
                        window.location.href = response.redirectUrl;
                    } else {
                        console.error('Server response does not contain a redirect URL.');
                    }
                },
                error: function(xhr, status, error) {
                    console.error('Error:', error);
                }
            });
        });
    });
</script>

{{!-- 
<script>
    document.addEventListener('DOMContentLoaded', function() {
        let answers = [];

        // Get all answer elements
        const answerElements = document.querySelectorAll('.answer');
        answerElements.forEach(function(answerElement) {
            answerElement.addEventListener('click', function() {
                const qKey = this.getAttribute('data-key');
                const slAns = this.getAttribute('data-answer');

                // Disable all answer buttons for the clicked question
                document.querySelectorAll('.' + qKey).forEach(function(element) {
                    if (element !== answerElement) {
                        element.disabled = true;
                    }
                });

                this.style.backgroundColor = 'yellow';

                // Push selected answer to the answers array
                answers.push({ qKey: qKey, slAns: slAns });
                this.disabled = true;
            });
        });

        const submitBtn = document.getElementById('submitBtn');
        submitBtn.addEventListener('click', function() {
            // Send answers to the server (you can customize this part)
            let ss = document.getElementById('ssno').value;
            let qw = window.location.href.split('/').pop();

            fetch(`/qd-view/${ss}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ answers: answers, qw: qw })
            })
            .then(response => response.json())
            .then(function(response) {
                console.log('Server response:', response);
                answers = [];
                // Check if the server response contains the new URL
                if (response && response.redirectUrl) {
                    window.location.href = response.redirectUrl;
                } else {
                    console.error('Server response does not contain a redirect URL.');
                }
            })
            .catch(function(error) {
                console.error('Error:', error);
            });
        });
    });
</script> --}}
